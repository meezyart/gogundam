import R from "ramda";
import React, { Component } from "react";
import { connect } from "react-redux";
import { Link } from "react-router";

import { fetchGundams, loadMoreGundams } from "actions";
import { getMeGundams } from "selectas";

class Gundams extends Component {
  componentDidMount() {
    this.props.fetchGundams();
  }

  renderGundams(gundamObj, index) {
    let gundam = gundamObj[0];
    // console.log("redering gundam...");
    let smDescription = `${R.take(80, gundam.info_text)}...`;
    // console.log(smDescription,gundam)
    return (
      <div className="col-md-4 col-sm-4 col-lg-4" key={index}>
        <div className="card">
          <img className="card-img-bottom" src={gundam.image} alt={gundam.name} />
          <div className="card-body">
            <h5 className="card-title">
              <Link to={`/gundams/${gundam.id}`}>{gundam.title}</Link>
            </h5>
            <h5 className="card-title">{gundam.price} </h5>
            <p className="card-text">{smDescription}</p>
            <p className="itemButton">
              <button className="btn btn-primary btn-block">Buy Now!</button>
              <Link
                className="btn btn-primary btn-block"
                to={`/gundams/${gundam.id}`}>
                More Info
              </Link>
            </p>
          </div>
          <div className="card-footer text-muted text-center" />
        </div>
      </div>
    );
  }
  render() {
    const { gundams, loadMoreGundams } = this.props;
    return (
      <div>
        <div className="book row">
        {gundams.map((gundam, index) => this.renderGundams(gundam, index))}
       </div>
       <div className='row'>
        <div className='col-md-12'>
            <button
            onClick={loadMoreGundams}
            className='pull-right btn btn-primary'>
            Load More
            </button>
        </div>
       </div>
      </div>
      
    );
  }
}

const mapStateToProps = state => ({
  gundams: getMeGundams(state)
});

const mapDispatchToProps = {
  fetchGundams,
  loadMoreGundams
};
export default connect(mapStateToProps, mapDispatchToProps)(Gundams);
